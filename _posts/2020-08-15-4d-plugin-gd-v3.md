---
layout: simple
title: GD v3
tags: plugin graphics v19
---

Process images using [GD Graphics Library](https://github.com/libgd/libgd).

<!--more-->

[miyako/4d-plugin-gd-v3](https://github.com/miyako/4d-plugin-gd-v3)

```4d
status:=imagefrompicture(image;format)
```

*format* 形式の画像を[*gd2*](https://libgd.github.io/manuals/2.3.0/files/gd_gd2-c.html)に変換して`status.image`に返します。成否は`status.success`に返されます。*format* は正確でなければなりません。

プラグインにはPHPの`GdImage`(https://www.php.net/manual/en/class.gdimage.php)クラスに相当するものがないため，GDライブラリの内部的なフォーマットをそのままピクチャー型として扱います。このフォーマットは固定長のチャンクサイズに画像データが配列されているため，アクセスが高速であるとされています。なお，プラグインのチャンクサイズは標準の[GD2_CHUNKSIZE](https://github.com/libgd/libgd/blob/master/src/gd.h#L1592)かつ無圧縮[GD2_FMT_RAW](https://github.com/libgd/libgd/blob/master/src/gd.h#L1597)です。

<div class="grid">
  <div class="syntax-th cell cell--2">Parameter</div>
  <div class="syntax-th cell cell--2">Type</div>
  <div class="syntax-th cell cell--8">Description</div>
  <div class="syntax-td cell cell--2">image</div>
  <div class="syntax-td cell cell--2">Picture</div>
  <div class="syntax-td cell cell--8"></div>        
  <div class="syntax-td cell cell--2">format</div>
  <div class="syntax-td cell cell--2">Integer</div>
  <div class="syntax-td cell cell--8"></div>   
  <div class="syntax-td cell cell--2">status</div>
  <div class="syntax-td cell cell--2">Object</div>
  <div class="syntax-td cell cell--8"></div>   
</div>

```4d
status:=imagetopicture(image;format)
```

[*gd2*](https://libgd.github.io/manuals/2.3.0/files/gd_gd2-c.html)形式の画像を*format* に変換して`status.image`に返します。成否は`status.success`に返されます。`IMG_WBMP`と`IMG_WEBP`は4Dで表示できないピクチャー形式なので，*gd2* と同じく内部的に`BLOB TO PICTURE`を呼び出してピクチャーに変換しています。ファイルとして書き出す場合，`WRITE PICTURE FILE`のようなピクチャーコマンドではなく，`PICTURE TO BLOB`でデータに変換した上でBlobとして扱う必要があります。

#### Image Format

Constant|Type|Description
------------|------|----
IMG_PNG | Integer| 0
IMG_BMP | Integer| 1
IMG_GIF | Integer| 2
IMG_JPEG | Integer| 3
IMG_TIFF | Integer| 4
IMG_WBMP | Integer| 5
IMG_WEBP | Integer| 6

